---
import { getCollection } from 'astro:content';
import MainPage from '../layouts/MainPage.astro';
import { PAGE_SIZE } from '../consts';

const posts = (await getCollection('blog'))
  .filter(p => !p.data.draft)
  .sort( (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());

const currentPage = 1;
const start = 0;
const end = PAGE_SIZE;

const paginatedPosts = posts.slice(start, end);
const totalPages = Math.ceil(posts.length / PAGE_SIZE);
---

<MainPage
  posts={paginatedPosts}
  currentPage={currentPage}
  totalPages={totalPages}
/>

